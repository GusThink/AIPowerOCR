<!DOCTYPE html>
<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIPowerOCR - Ekstrak Teks dari Gambar</title>
    <meta name="description" content="Tempelkan gambar atau screenshot untuk mengekstrak teks secara instan dengan teknologi AI OCR. Mendukung Bahasa Indonesia dan Arab.">

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+Arabic:wght@400;500;700&display=swap" rel="stylesheet">

    <script src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js'></script>
    
    <style>
        /* Apply custom fonts */
        body { font-family: 'Inter', sans-serif; }
        .font-arabic { font-family: 'Noto Sans Arabic', sans-serif; }
        
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        .dark ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background: #475569; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        .dark ::-webkit-scrollbar-thumb:hover { background: #64748b; }

        /* Smooth transitions for a polished feel */
        * { transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, opacity 0.3s ease; }
        .sidebar-transition { transition: transform 0.3s ease-in-out; }
    </style>
    <script>
        // Tailwind dark mode configuration
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
</head>
<body class="bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-200 antialiased min-h-screen flex items-center justify-center p-4">

    <div id="sidebar-overlay" class="fixed inset-0 bg-black/60 z-40 opacity-0 pointer-events-none transition-opacity duration-300"></div>
    <aside id="sidebar" class="fixed top-0 left-0 h-full w-64 bg-white dark:bg-slate-800 z-50 shadow-lg transform -translate-x-full sidebar-transition">
        <div class="p-4">
            <div class="flex justify-between items-center mb-6">
                <h2 class="font-bold text-lg text-sky-600 dark:text-sky-400">Menu</h2>
                <button id="close-sidebar-btn" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700">
                     <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>
            <nav class="flex flex-col gap-2">
                <a href="#" class="flex items-center gap-3 p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>
                    <span>Tentang Web</span>
                </a>
                <a href="#" class="flex items-center gap-3 p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700">
                     <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-square-text"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/><path d="M13 8H7"/><path d="M17 12H7"/></svg>
                    <span>Kritik & Saran</span>
                </a>
            </nav>
        </div>
    </aside>

    <div id="app-container" class="w-full max-w-6xl bg-slate-100 dark:bg-slate-900/50 p-4 sm:p-6 md:p-8 rounded-2xl shadow-sm transition-all duration-300">
        
        <header class="flex justify-between items-center mb-6">
            <div class="flex items-center gap-3">
                 <button id="menu-btn" title="Buka Menu" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-sky-500">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
                </button>
                <div>
                    <h1 class="text-xl sm:text-2xl font-bold text-sky-600 dark:text-sky-400">AIPowerOCR</h1>
                    <p class="text-slate-500 dark:text-slate-400 mt-1 text-xs sm:text-sm">Ekstrak Teks dari Gambar, Instan & Akurat</p>
                </div>
            </div>
            <nav class="flex items-center gap-2">
                <button id="theme-toggle" title="Ubah Tema" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-sky-500">
                    <svg id="theme-icon-light" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sun"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
                    <svg id="theme-icon-dark" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon hidden"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
                </button>
            </nav>
        </header>

        <div class="flex justify-center items-center gap-2 mb-6">
            <button data-view="mobile" class="view-btn p-2 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800" title="Tampilan HP">
                 <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-smartphone"><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></svg>
            </button>
             <button data-view="tablet" class="view-btn p-2 rounded-lg hover:bg-slate-200 dark:hover:bg-slate-800" title="Tampilan Tablet">
                 <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tablet"><rect width="16" height="20" x="4" y="2" rx="2" ry="2"/><line x1="12" x2="12.01" y1="18" y2="18"/></svg>
            </button>
            <button data-view="laptop" class="view-btn p-2 rounded-lg bg-slate-200 dark:bg-slate-800" title="Tampilan Laptop">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-laptop"><path d="M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55A1 1 0 0 1 20.7 20H3.3a1 1 0 0 1-.58-1.45L4 16"/></svg>
            </button>
        </div>

        <main class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8">
            <div class="flex flex-col h-[50vh] lg:h-auto">
                <div class="mb-3">
                    <p class="text-sm text-slate-500 dark:text-slate-400">
                        Tempel screenshot (<kbd class="px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded-lg dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600">Ctrl</kbd>+<kbd class="px-2 py-1 text-xs font-semibold text-gray-800 bg-gray-100 border border-gray-200 rounded-lg dark:bg-gray-700 dark:text-gray-100 dark:border-gray-600">V</kbd>) atau <label for="upload-input" class="text-sky-600 dark:text-sky-400 font-medium hover:underline cursor-pointer">unggah file</label>.
                        <input type="file" id="upload-input" class="hidden" accept="image/*">
                    </p>
                </div>
                <div id="paste-area" class="relative w-full flex-grow bg-white dark:bg-slate-800/50 border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl flex justify-center items-center text-center p-4 cursor-pointer hover:border-sky-500 dark:hover:border-sky-500 focus:outline-none focus:ring-2 focus:ring-sky-500" tabindex="0">
                    <div id="paste-placeholder" class="text-slate-400 dark:text-slate-500 transition-opacity duration-300">
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-image-plus mx-auto mb-2"><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7"/><line x1="16" x2="22" y1="5" y2="5"/><line x1="19" x2="19" y1="2" y2="8"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>
                        <p>Area Tempel atau Unggah Gambar</p>
                    </div>
                    <img id="pasted-image" src="" alt="Gambar yang ditempel" class="hidden max-w-full max-h-full object-contain rounded-lg"/>
                    <div id="loader" class="absolute inset-0 bg-black/70 flex flex-col justify-center items-center text-white rounded-xl hidden transition-opacity duration-300">
                        <svg class="animate-spin h-8 w-8 text-white mb-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                        <p id="loader-text" class="text-sm font-medium">Memproses gambar...</p>
                    </div>
                </div>
            </div>

            <div class="flex flex-col h-[50vh] lg:h-auto">
                <div class="flex justify-between items-center mb-3">
                     <h2 class="font-semibold text-lg">Hasil Teks</h2>
                     <div class="flex gap-2">
                        <button id="copy-btn" title="Salin Hasil" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-800 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-sky-500" disabled>
                           <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                        </button>
                        <button id="save-btn" title="Simpan sebagai .txt" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-800 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-sky-500" disabled>
                           <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-download"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></svg>
                        </button>
                     </div>
                </div>
                <textarea id="output-text" readonly class="font-arabic w-full flex-grow bg-white dark:bg-slate-800/50 border border-slate-300 dark:border-slate-700 rounded-xl p-4 resize-none focus:outline-none focus:ring-2 focus:ring-sky-500" placeholder="Hasil ekstraksi teks akan muncul di sini..."></textarea>
            </div>
        </main>
        
        <div id="notification" class="fixed bottom-5 right-5 text-white text-sm py-2 px-4 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-500 ease-out z-50">
            Pesan notifikasi
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // === DOM Element Selections ===
            const pasteArea = document.getElementById('paste-area');
            const pastePlaceholder = document.getElementById('paste-placeholder');
            const pastedImage = document.getElementById('pasted-image');
            const outputText = document.getElementById('output-text');
            const copyBtn = document.getElementById('copy-btn');
            const saveBtn = document.getElementById('save-btn');
            const loader = document.getElementById('loader');
            const loaderText = document.getElementById('loader-text');
            const notification = document.getElementById('notification');
            const themeToggle = document.getElementById('theme-toggle');
            const themeIconLight = document.getElementById('theme-icon-light');
            const themeIconDark = document.getElementById('theme-icon-dark');
            const menuBtn = document.getElementById('menu-btn');
            const closeSidebarBtn = document.getElementById('close-sidebar-btn');
            const sidebar = document.getElementById('sidebar');
            const sidebarOverlay = document.getElementById('sidebar-overlay');
            const appContainer = document.getElementById('app-container');
            const viewBtns = document.querySelectorAll('.view-btn');
            const uploadInput = document.getElementById('upload-input');

            let currentWorker = null;
            
            // === Sidebar Management ===
            const openSidebar = () => {
                sidebar.classList.remove('-translate-x-full');
                sidebarOverlay.classList.remove('opacity-0', 'pointer-events-none');
            };
            const closeSidebar = () => {
                sidebar.classList.add('-translate-x-full');
                sidebarOverlay.classList.add('opacity-0', 'pointer-events-none');
            };
            menuBtn.addEventListener('click', openSidebar);
            closeSidebarBtn.addEventListener('click', closeSidebar);
            sidebarOverlay.addEventListener('click', closeSidebar);
            
            // === View Mode Management ===
            viewBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const view = btn.dataset.view;
                    viewBtns.forEach(b => b.classList.remove('bg-slate-200', 'dark:bg-slate-800'));
                    btn.classList.add('bg-slate-200', 'dark:bg-slate-800');
                    appContainer.classList.remove('max-w-6xl', 'max-w-3xl', 'max-w-lg');
                    if (view === 'laptop') appContainer.classList.add('max-w-6xl');
                    else if (view === 'tablet') appContainer.classList.add('max-w-3xl');
                    else appContainer.classList.add('max-w-lg');
                });
            });

            // === Theme Management ===
            const applyTheme = (theme) => {
                if (theme === 'dark') {
                    document.documentElement.classList.add('dark');
                    themeIconLight.classList.add('hidden');
                    themeIconDark.classList.remove('hidden');
                } else {
                    document.documentElement.classList.remove('dark');
                    themeIconLight.classList.remove('hidden');
                    themeIconDark.classList.add('hidden');
                }
            };
            const savedTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            applyTheme(savedTheme);
            themeToggle.addEventListener('click', () => {
                const newTheme = document.documentElement.classList.contains('dark') ? 'light' : 'dark';
                localStorage.setItem('theme', newTheme);
                applyTheme(newTheme);
            });

            // === OCR Processing Logic ===
            const processImage = async (imageFile) => {
                pastedImage.src = URL.createObjectURL(imageFile);
                pastedImage.classList.remove('hidden');
                pastePlaceholder.classList.add('opacity-0');
                loader.classList.remove('hidden');
                outputText.value = '';
                copyBtn.disabled = true;
                saveBtn.disabled = true;

                try {
                    currentWorker = await Tesseract.createWorker({
                        logger: m => {
                            if (m.status === 'recognizing text') {
                                loaderText.textContent = `Mengenali teks... (${Math.round(m.progress * 100)}%)`;
                            } else {
                                loaderText.textContent = 'Memuat model bahasa...';
                            }
                        }
                    });
                    await currentWorker.loadLanguage('ind+ara');
                    await currentWorker.initialize('ind+ara');
                    const { data: { text } } = await currentWorker.recognize(imageFile);
                    outputText.value = text || "Tidak ada teks yang terdeteksi.";
                    showNotification(text ? 'Teks berhasil diekstrak!' : 'Tidak ada teks yang terdeteksi.', text ? 'success' : 'info');
                    if (text) {
                        copyBtn.disabled = false;
                        saveBtn.disabled = false;
                    }
                } catch (error) {
                    console.error("OCR Error:", error);
                    outputText.value = "Terjadi kesalahan saat memproses gambar.";
                    showNotification('Gagal memproses gambar.', 'error');
                } finally {
                    loader.classList.add('hidden');
                    if (currentWorker) {
                        await currentWorker.terminate();
                        currentWorker = null;
                    }
                }
            };

            // === Event Handlers (Paste, Drop, Upload) ===
            document.addEventListener('paste', (event) => {
                const items = event.clipboardData.items;
                for (const item of items) {
                    if (item.type.indexOf('image') !== -1) {
                        const imageFile = item.getAsFile();
                        if (imageFile) {
                            event.preventDefault();
                            processImage(imageFile);
                        }
                        break;
                    }
                }
            });

            uploadInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    processImage(file);
                }
            });

            // === Button Actions ===
            copyBtn.addEventListener('click', () => {
                if (outputText.value) {
                    navigator.clipboard.writeText(outputText.value)
                        .then(() => showNotification('Hasil berhasil disalin!'))
                        .catch(() => showNotification('Gagal menyalin.', 'error'));
                }
            });

            saveBtn.addEventListener('click', () => {
                if (outputText.value) {
                    const blob = new Blob([outputText.value], { type: 'text/plain;charset=utf-8' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'hasil-ocr.txt';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    showNotification('File .txt berhasil disimpan!');
                }
            });

            // === Notification Helper ===
            let notificationTimeout;
            const showNotification = (message, type = 'success') => {
                notification.textContent = message;
                notification.classList.remove('bg-sky-600', 'bg-red-600', 'bg-slate-600');
                if (type === 'success') notification.classList.add('bg-sky-600');
                else if (type === 'error') notification.classList.add('bg-red-600');
                else notification.classList.add('bg-slate-600');
                clearTimeout(notificationTimeout);
                notification.classList.remove('opacity-0', 'translate-y-20');
                notificationTimeout = setTimeout(() => {
                    notification.classList.add('opacity-0', 'translate-y-20');
                }, 3000);
            };
        });
    </script>
</body>
</html>
